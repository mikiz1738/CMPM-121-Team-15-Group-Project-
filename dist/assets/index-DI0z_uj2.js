var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{p as s,P as i}from"./phaser-DgVbYced.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class o extends s.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/Grass_Tile.gif"),this.load.image("dirt","assets/Dirt Tile.gif"),this.load.spritesheet("player","assets/PigWalk.png",{frameWidth:240,frameHeight:330}),this.load.image("cactus","assets/Cactus.gif"),this.load.image("sunflower","assets/Sunflower.gif"),this.load.image("corn","assets/Corn.gif"),this.load.json("externalDSL","../src/externalDSL.json")}create(){this.scene.start("Preloader")}}const n={normal:{levelWidth:5,levelHeight:5,winCondition:5},tutorial:{levelWidth:3,levelHeight:3,winCondition:2},plants:[{name:"Cactus",requiredWater:2,requiredSunEnergy:6,growthTime:12,sprite:"cactus",growthStage:0,daysPlanted:0,hasReachedMaxGrowth:!1},{name:"Sunflower",requiredWater:4,requiredSunEnergy:8,growthTime:10,sprite:"sunflower",growthStage:0,daysPlanted:0,hasReachedMaxGrowth:!1},{name:"Corn",requiredWater:8,requiredSunEnergy:4,growthTime:8,sprite:"corn",growthStage:0,daysPlanted:0,hasReachedMaxGrowth:!1}]};class a{constructor(t){e(this,"plants"),this.plants=t.plants.map((t=>this.createPlant(t)))}static fromJSON(t){const e=JSON.parse(t);return new a(e)}createPlant(t){return{name:t.name,requiredWater:t.requiredWater,requiredSunEnergy:t.requiredSunEnergy,growthTime:t.growthTime,sprite:t.sprite,growthStage:t.growthStage,daysPlanted:t.daysPlanted,hasReachedMaxGrowth:t.hasReachedMaxGrowth}}}a.fromJSON(JSON.stringify(n));const r=a.fromJSON(JSON.stringify(n)).plants;function l(t){t.plantButtons.each((t=>{t instanceof i.GameObjects.Rectangle&&t.setFillStyle(2236962)}));const e=t.selectedPlantType;if(null!==e){const s=t.plantButtons.getAt(2*e);s&&s.setFillStyle(5592575)}}const h=t=>"string"==typeof t,d=()=>{let t,e;const s=new Promise(((s,i)=>{t=s,e=i}));return s.resolve=t,s.reject=e,s},c=t=>null==t?"":""+t,u=/###/g,g=t=>t&&t.indexOf("###")>-1?t.replace(u,"."):t,p=t=>!t||h(t),f=(t,e,s)=>{const i=h(e)?e.split("."):e;let o=0;for(;o<i.length-1;){if(p(t))return{};const e=g(i[o]);!t[e]&&s&&(t[e]=new s),t=Object.prototype.hasOwnProperty.call(t,e)?t[e]:{},++o}return p(t)?{}:{obj:t,k:g(i[o])}},y=(t,e,s)=>{const{obj:i,k:o}=f(t,e,Object);if(void 0!==i||1===e.length)return void(i[o]=s);let n=e[e.length-1],a=e.slice(0,e.length-1),r=f(t,a,Object);for(;void 0===r.obj&&a.length;)n=`${a[a.length-1]}.${n}`,a=a.slice(0,a.length-1),r=f(t,a,Object),(null==r?void 0:r.obj)&&void 0!==r.obj[`${r.k}.${n}`]&&(r.obj=void 0);r.obj[`${r.k}.${n}`]=s},m=(t,e)=>{const{obj:s,k:i}=f(t,e);if(s)return s[i]},v=(t,e,s)=>{for(const i in e)"__proto__"!==i&&"constructor"!==i&&(i in t?h(t[i])||t[i]instanceof String||h(e[i])||e[i]instanceof String?s&&(t[i]=e[i]):v(t[i],e[i],s):t[i]=e[i]);return t},S=t=>t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const x=t=>h(t)?t.replace(/[&<>"'\/]/g,(t=>b[t])):t,w=[" ",",","?","!",";"],k=new class{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const e=this.regExpMap.get(t);if(void 0!==e)return e;const s=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,s),this.regExpQueue.push(t),s}}(20),L=function(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!t)return;if(t[e])return t[e];const i=e.split(s);let o=t;for(let n=0;n<i.length;){if(!o||"object"!=typeof o)return;let t,e="";for(let a=n;a<i.length;++a)if(a!==n&&(e+=s),e+=i[a],t=o[e],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<i.length-1)continue;n+=a-n+1;break}o=t}return o},O=t=>null==t?void 0:t.replace("_","-"),A={type:"logger",log(t){this.output("log",t)},warn(t){this.output("warn",t)},error(t){this.output("error",t)},output(t,e){var s,i;null==(i=null==(s=null==console?void 0:console[t])?void 0:s.apply)||i.call(s,console,e)}};class C{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(t,e)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=e.prefix||"i18next:",this.logger=t||A,this.options=e,this.debug=e.debug}log(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.forward(e,"log","",!0)}warn(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.forward(e,"warn","",!0)}error(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.forward(e,"error","")}deprecate(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(t,e,s,i){return i&&!this.debug?null:(h(t[0])&&(t[0]=`${s}${this.prefix} ${t[0]}`),this.logger[e](t))}create(t){return new C(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new C(this.logger,t)}}var $=new C;class P{constructor(){this.observers={}}on(t,e){return t.split(" ").forEach((t=>{this.observers[t]||(this.observers[t]=new Map);const s=this.observers[t].get(e)||0;this.observers[t].set(e,s+1)})),this}off(t,e){this.observers[t]&&(e?this.observers[t].delete(e):delete this.observers[t])}emit(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];this.observers[t]&&Array.from(this.observers[t].entries()).forEach((t=>{let[e,i]=t;for(let o=0;o<i;o++)e(...s)})),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach((e=>{let[i,o]=e;for(let n=0;n<o;n++)i.apply(i,[t,...s])}))}}class R extends P{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const e=this.options.ns.indexOf(t);e>-1&&this.options.ns.splice(e,1)}getResource(t,e,s){var i,o;let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,r=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let l;t.indexOf(".")>-1?l=t.split("."):(l=[t,e],s&&(Array.isArray(s)?l.push(...s):h(s)&&a?l.push(...s.split(a)):l.push(s)));const d=m(this.data,l);return!d&&!e&&!s&&t.indexOf(".")>-1&&(t=l[0],e=l[1],s=l.slice(2).join(".")),!d&&r&&h(s)?L(null==(o=null==(i=this.data)?void 0:i[t])?void 0:o[e],s,a):d}addResource(t,e,s,i){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const n=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let a=[t,e];s&&(a=a.concat(n?s.split(n):s)),t.indexOf(".")>-1&&(a=t.split("."),i=e,e=a[1]),this.addNamespaces(e),y(this.data,a,i),o.silent||this.emit("added",t,e,s,i)}addResources(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const o in s)(h(s[o])||Array.isArray(s[o]))&&this.addResource(t,e,o,s[o],{silent:!0});i.silent||this.emit("added",t,e,s)}addResourceBundle(t,e,s,i,o){let n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[t,e];t.indexOf(".")>-1&&(a=t.split("."),i=s,s=e,e=a[1]),this.addNamespaces(e);let r=m(this.data,a)||{};n.skipCopy||(s=JSON.parse(JSON.stringify(s))),i?v(r,s,o):r={...r,...s},y(this.data,a,r),n.silent||this.emit("added",t,e,s)}removeResourceBundle(t,e){this.hasResourceBundle(t,e)&&delete this.data[t][e],this.removeNamespaces(e),this.emit("removed",t,e)}hasResourceBundle(t,e){return void 0!==this.getResource(t,e)}getResourceBundle(t,e){return e||(e=this.options.defaultNS),this.getResource(t,e)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const e=this.getDataByLanguage(t);return!!(e&&Object.keys(e)||[]).find((t=>e[t]&&Object.keys(e[t]).length>0))}toJSON(){return this.data}}var N={processors:{},addPostProcessor(t){this.processors[t.name]=t},handle(t,e,s,i,o){return t.forEach((t=>{var n;e=(null==(n=this.processors[t])?void 0:n.process(e,s,i,o))??e})),e}};const T={};class I extends P{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var s,i;super(),s=t,i=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach((t=>{s[t]&&(i[t]=s[t])})),this.options=e,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=$.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==t)return!1;const s=this.resolve(t,e);return void 0!==(null==s?void 0:s.res)}extractFromKey(t,e){let s=void 0!==e.nsSeparator?e.nsSeparator:this.options.nsSeparator;void 0===s&&(s=":");const i=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator;let o=e.ns||this.options.defaultNS||[];const n=s&&t.indexOf(s)>-1,a=!(this.options.userDefinedKeySeparator||e.keySeparator||this.options.userDefinedNsSeparator||e.nsSeparator||((t,e,s)=>{e=e||"",s=s||"";const i=w.filter((t=>e.indexOf(t)<0&&s.indexOf(t)<0));if(0===i.length)return!0;const o=k.getRegExp(`(${i.map((t=>"?"===t?"\\?":t)).join("|")})`);let n=!o.test(t);if(!n){const e=t.indexOf(s);e>0&&!o.test(t.substring(0,e))&&(n=!0)}return n})(t,s,i));if(n&&!a){const e=t.match(this.interpolator.nestingRegexp);if(e&&e.length>0)return{key:t,namespaces:h(o)?[o]:o};const n=t.split(s);(s!==i||s===i&&this.options.ns.indexOf(n[0])>-1)&&(o=n.shift()),t=n.join(i)}return{key:t,namespaces:h(o)?[o]:o}}translate(t,e,s){if("object"!=typeof e&&this.options.overloadTranslationOptionHandler&&(e=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof e&&(e={...e}),e||(e={}),null==t)return"";Array.isArray(t)||(t=[String(t)]);const i=void 0!==e.returnDetails?e.returnDetails:this.options.returnDetails,o=void 0!==e.keySeparator?e.keySeparator:this.options.keySeparator,{key:n,namespaces:a}=this.extractFromKey(t[t.length-1],e),r=a[a.length-1],l=e.lng||this.language,d=e.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===(null==l?void 0:l.toLowerCase())){if(d){const t=e.nsSeparator||this.options.nsSeparator;return i?{res:`${r}${t}${n}`,usedKey:n,exactUsedKey:n,usedLng:l,usedNS:r,usedParams:this.getUsedParamsDetails(e)}:`${r}${t}${n}`}return i?{res:n,usedKey:n,exactUsedKey:n,usedLng:l,usedNS:r,usedParams:this.getUsedParamsDetails(e)}:n}const c=this.resolve(t,e);let u=null==c?void 0:c.res;const g=(null==c?void 0:c.usedKey)||n,p=(null==c?void 0:c.exactUsedKey)||n,f=Object.prototype.toString.apply(u),y=void 0!==e.joinArrays?e.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,v=!h(u)&&"boolean"!=typeof u&&"number"!=typeof u;if(!(m&&u&&v&&["[object Number]","[object Function]","[object RegExp]"].indexOf(f)<0)||h(y)&&Array.isArray(u))if(m&&h(y)&&Array.isArray(u))u=u.join(y),u&&(u=this.extendTranslation(u,t,e,s));else{let i=!1,a=!1;const d=void 0!==e.count&&!h(e.count),g=I.hasDefaultValue(e),p=d?this.pluralResolver.getSuffix(l,e.count,e):"",f=e.ordinal&&d?this.pluralResolver.getSuffix(l,e.count,{ordinal:!1}):"",y=d&&!e.ordinal&&0===e.count,m=y&&e[`defaultValue${this.options.pluralSeparator}zero`]||e[`defaultValue${p}`]||e[`defaultValue${f}`]||e.defaultValue;!this.isValidLookup(u)&&g&&(i=!0,u=m),this.isValidLookup(u)||(a=!0,u=n);const v=(e.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:u,S=g&&m!==u&&this.options.updateMissing;if(a||i||S){if(this.logger.log(S?"updateKey":"missingKey",l,r,n,S?m:u),o){const t=this.resolve(n,{...e,keySeparator:!1});t&&t.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let t=[];const s=this.languageUtils.getFallbackCodes(this.options.fallbackLng,e.lng||this.language);if("fallback"===this.options.saveMissingTo&&s&&s[0])for(let e=0;e<s.length;e++)t.push(s[e]);else"all"===this.options.saveMissingTo?t=this.languageUtils.toResolveHierarchy(e.lng||this.language):t.push(e.lng||this.language);const i=(t,s,i)=>{var o;const n=g&&i!==u?i:v;this.options.missingKeyHandler?this.options.missingKeyHandler(t,r,s,n,S,e):(null==(o=this.backendConnector)?void 0:o.saveMissing)&&this.backendConnector.saveMissing(t,r,s,n,S,e),this.emit("missingKey",t,r,s,u)};this.options.saveMissing&&(this.options.saveMissingPlurals&&d?t.forEach((t=>{const s=this.pluralResolver.getSuffixes(t,e);y&&e[`defaultValue${this.options.pluralSeparator}zero`]&&s.indexOf(`${this.options.pluralSeparator}zero`)<0&&s.push(`${this.options.pluralSeparator}zero`),s.forEach((s=>{i([t],n+s,e[`defaultValue${s}`]||m)}))})):i(t,n,m))}u=this.extendTranslation(u,t,e,c,s),a&&u===n&&this.options.appendNamespaceToMissingKey&&(u=`${r}:${n}`),(a||i)&&this.options.parseMissingKeyHandler&&(u=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${r}:${n}`:n,i?u:void 0))}else{if(!e.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const t=this.options.returnedObjectHandler?this.options.returnedObjectHandler(g,u,{...e,ns:a}):`key '${n} (${this.language})' returned an object instead of string.`;return i?(c.res=t,c.usedParams=this.getUsedParamsDetails(e),c):t}if(o){const t=Array.isArray(u),s=t?[]:{},i=t?p:g;for(const n in u)if(Object.prototype.hasOwnProperty.call(u,n)){const t=`${i}${o}${n}`;s[n]=this.translate(t,{...e,joinArrays:!1,ns:a}),s[n]===t&&(s[n]=u[n])}u=s}}return i?(c.res=u,c.usedParams=this.getUsedParamsDetails(e),c):u}extendTranslation(t,e,s,i,o){var n,a,r=this;if(null==(n=this.i18nFormat)?void 0:n.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...s},s.lng||this.language||i.usedLng,i.usedNS,i.usedKey,{resolved:i});else if(!s.skipInterpolation){s.interpolation&&this.interpolator.init({...s,interpolation:{...this.options.interpolation,...s.interpolation}});const n=h(t)&&(void 0!==(null==(a=null==s?void 0:s.interpolation)?void 0:a.skipOnVariables)?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let l;if(n){const e=t.match(this.interpolator.nestingRegexp);l=e&&e.length}let d=s.replace&&!h(s.replace)?s.replace:s;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),t=this.interpolator.interpolate(t,d,s.lng||this.language||i.usedLng,s),n){const e=t.match(this.interpolator.nestingRegexp);l<(e&&e.length)&&(s.nest=!1)}!s.lng&&i&&i.res&&(s.lng=this.language||i.usedLng),!1!==s.nest&&(t=this.interpolator.nest(t,(function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return(null==o?void 0:o[0])!==i[0]||s.context?r.translate(...i,e):(r.logger.warn(`It seems you are nesting recursively key: ${i[0]} in key: ${e[0]}`),null)}),s)),s.interpolation&&this.interpolator.reset()}const l=s.postProcess||this.options.postProcess,d=h(l)?[l]:l;return null!=t&&(null==d?void 0:d.length)&&!1!==s.applyPostProcessor&&(t=N.handle(d,t,e,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...i,usedParams:this.getUsedParamsDetails(s)},...s}:s,this)),t}resolve(t){let e,s,i,o,n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h(t)&&(t=[t]),t.forEach((t=>{if(this.isValidLookup(e))return;const r=this.extractFromKey(t,a),l=r.key;s=l;let d=r.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const c=void 0!==a.count&&!h(a.count),u=c&&!a.ordinal&&0===a.count,g=void 0!==a.context&&(h(a.context)||"number"==typeof a.context)&&""!==a.context,p=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);d.forEach((t=>{var r,h;this.isValidLookup(e)||(n=t,T[`${p[0]}-${t}`]||!(null==(r=this.utils)?void 0:r.hasLoadedNamespace)||(null==(h=this.utils)?void 0:h.hasLoadedNamespace(n))||(T[`${p[0]}-${t}`]=!0,this.logger.warn(`key "${s}" for languages "${p.join(", ")}" won't get resolved as namespace "${n}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),p.forEach((s=>{var n;if(this.isValidLookup(e))return;o=s;const r=[l];if(null==(n=this.i18nFormat)?void 0:n.addLookupKeys)this.i18nFormat.addLookupKeys(r,l,s,t,a);else{let t;c&&(t=this.pluralResolver.getSuffix(s,a.count,a));const e=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(r.push(l+t),a.ordinal&&0===t.indexOf(i)&&r.push(l+t.replace(i,this.options.pluralSeparator)),u&&r.push(l+e)),g){const s=`${l}${this.options.contextSeparator}${a.context}`;r.push(s),c&&(r.push(s+t),a.ordinal&&0===t.indexOf(i)&&r.push(s+t.replace(i,this.options.pluralSeparator)),u&&r.push(s+e))}}let h;for(;h=r.pop();)this.isValidLookup(e)||(i=h,e=this.getResource(s,t,h,a))})))}))})),{res:e,usedKey:s,exactUsedKey:i,usedLng:o,usedNS:n}}isValidLookup(t){return!(void 0===t||!this.options.returnNull&&null===t||!this.options.returnEmptyString&&""===t)}getResource(t,e,s){var i;let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(null==(i=this.i18nFormat)?void 0:i.getResource)?this.i18nFormat.getResource(t,e,s,o):this.resourceStore.getResource(t,e,s,o)}getUsedParamsDetails(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],s=t.replace&&!h(t.replace);let i=s?t.replace:t;if(s&&void 0!==t.count&&(i.count=t.count),this.options.interpolation.defaultVariables&&(i={...this.options.interpolation.defaultVariables,...i}),!s){i={...i};for(const t of e)delete i[t]}return i}static hasDefaultValue(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&"defaultValue"===e.substring(0,12)&&void 0!==t[e])return!0;return!1}}class E{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=$.create("languageUtils")}getScriptPartFromCode(t){if(!(t=O(t))||t.indexOf("-")<0)return null;const e=t.split("-");return 2===e.length?null:(e.pop(),"x"===e[e.length-1].toLowerCase()?null:this.formatLanguageCode(e.join("-")))}getLanguagePartFromCode(t){if(!(t=O(t))||t.indexOf("-")<0)return t;const e=t.split("-");return this.formatLanguageCode(e[0])}formatLanguageCode(t){if(h(t)&&t.indexOf("-")>-1){let s;try{s=Intl.getCanonicalLocales(t)[0]}catch(e){}return s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s||(this.options.lowerCaseLng?t.toLowerCase():t)}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let e;return t.forEach((t=>{if(e)return;const s=this.formatLanguageCode(t);this.options.supportedLngs&&!this.isSupportedCode(s)||(e=s)})),!e&&this.options.supportedLngs&&t.forEach((t=>{if(e)return;const s=this.getLanguagePartFromCode(t);if(this.isSupportedCode(s))return e=s;e=this.options.supportedLngs.find((t=>t===s?t:t.indexOf("-")<0&&s.indexOf("-")<0?void 0:t.indexOf("-")>0&&s.indexOf("-")<0&&t.substring(0,t.indexOf("-"))===s||0===t.indexOf(s)&&s.length>1?t:void 0))})),e||(e=this.getFallbackCodes(this.options.fallbackLng)[0]),e}getFallbackCodes(t,e){if(!t)return[];if("function"==typeof t&&(t=t(e)),h(t)&&(t=[t]),Array.isArray(t))return t;if(!e)return t.default||[];let s=t[e];return s||(s=t[this.getScriptPartFromCode(e)]),s||(s=t[this.formatLanguageCode(e)]),s||(s=t[this.getLanguagePartFromCode(e)]),s||(s=t.default),s||[]}toResolveHierarchy(t,e){const s=this.getFallbackCodes(e||this.options.fallbackLng||[],t),i=[],o=t=>{t&&(this.isSupportedCode(t)?i.push(t):this.logger.warn(`rejecting language code not found in supportedLngs: ${t}`))};return h(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(t)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(t)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(t))):h(t)&&o(this.formatLanguageCode(t)),s.forEach((t=>{i.indexOf(t)<0&&o(this.formatLanguageCode(t))})),i}}const j={zero:0,one:1,two:2,few:3,many:4,other:5},F={select:t=>1===t?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class D{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=t,this.options=e,this.logger=$.create("pluralResolver"),this.pluralRulesCache={}}addRule(t,e){this.rules[t]=e}clearCache(){this.pluralRulesCache={}}getRule(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=O("dev"===t?"en":t),i=e.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:s,type:i});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let n;try{n=new Intl.PluralRules(s,{type:i})}catch(a){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),F;if(!t.match(/-|_/))return F;const s=this.languageUtils.getLanguagePartFromCode(t);n=this.getRule(s,e)}return this.pluralRulesCache[o]=n,n}needsPlural(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getRule(t,e);return s||(s=this.getRule("dev",e)),(null==s?void 0:s.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(t,s).map((t=>`${e}${t}`))}getSuffixes(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=this.getRule(t,e);return s||(s=this.getRule("dev",e)),s?s.resolvedOptions().pluralCategories.sort(((t,e)=>j[t]-j[e])).map((t=>`${this.options.prepend}${e.ordinal?`ordinal${this.options.prepend}`:""}${t}`)):[]}getSuffix(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.getRule(t,s);return i?`${this.options.prepend}${s.ordinal?`ordinal${this.options.prepend}`:""}${i.select(e)}`:(this.logger.warn(`no plural rule found for: ${t}`),this.getSuffix("dev",e,s))}}const M=function(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=((t,e,s)=>{const i=m(t,s);return void 0!==i?i:m(e,s)})(t,e,s);return!n&&o&&h(s)&&(n=L(t,s,i),void 0===n&&(n=L(e,s,i))),n},U=t=>t.replace(/\$/g,"$$$$");class V{constructor(){var t;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=$.create("interpolator"),this.options=e,this.format=(null==(t=null==e?void 0:e.interpolation)?void 0:t.format)||(t=>t),this.init(e)}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:e,escapeValue:s,useRawValueToEscape:i,prefix:o,prefixEscaped:n,suffix:a,suffixEscaped:r,formatSeparator:l,unescapeSuffix:h,unescapePrefix:d,nestingPrefix:c,nestingPrefixEscaped:u,nestingSuffix:g,nestingSuffixEscaped:p,nestingOptionsSeparator:f,maxReplaces:y,alwaysFormat:m}=t.interpolation;this.escape=void 0!==e?e:x,this.escapeValue=void 0===s||s,this.useRawValueToEscape=void 0!==i&&i,this.prefix=o?S(o):n||"{{",this.suffix=a?S(a):r||"}}",this.formatSeparator=l||",",this.unescapePrefix=h?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":h||"",this.nestingPrefix=c?S(c):u||S("$t("),this.nestingSuffix=g?S(g):p||S(")"),this.nestingOptionsSeparator=f||",",this.maxReplaces=y||1e3,this.alwaysFormat=void 0!==m&&m,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(t,e)=>(null==t?void 0:t.source)===e?(t.lastIndex=0,t):new RegExp(e,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,e,s,i){var o;let n,a,r;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=t=>{if(t.indexOf(this.formatSeparator)<0){const o=M(e,l,t,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,s,{...i,...e,interpolationkey:t}):o}const o=t.split(this.formatSeparator),n=o.shift().trim(),a=o.join(this.formatSeparator).trim();return this.format(M(e,l,n,this.options.keySeparator,this.options.ignoreJSONStructure),a,s,{...i,...e,interpolationkey:n})};this.resetRegExp();const u=(null==i?void 0:i.missingInterpolationHandler)||this.options.missingInterpolationHandler,g=void 0!==(null==(o=null==i?void 0:i.interpolation)?void 0:o.skipOnVariables)?i.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:t=>U(t)},{regex:this.regexp,safeValue:t=>this.escapeValue?U(this.escape(t)):U(t)}].forEach((e=>{for(r=0;n=e.regex.exec(t);){const s=n[1].trim();if(a=d(s),void 0===a)if("function"==typeof u){const e=u(t,n,i);a=h(e)?e:""}else if(i&&Object.prototype.hasOwnProperty.call(i,s))a="";else{if(g){a=n[0];continue}this.logger.warn(`missed to pass in variable ${s} for interpolating ${t}`),a=""}else h(a)||this.useRawValueToEscape||(a=c(a));const o=e.safeValue(a);if(t=t.replace(n[0],o),g?(e.regex.lastIndex+=a.length,e.regex.lastIndex-=n[0].length):e.regex.lastIndex=0,r++,r>=this.maxReplaces)break}})),t}nest(t,e){let s,i,o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(t,e)=>{const s=this.nestingOptionsSeparator;if(t.indexOf(s)<0)return t;const i=t.split(new RegExp(`${s}[ ]*{`));let n=`{${i[1]}`;t=i[0],n=this.interpolate(n,o);const a=n.match(/'/g),r=n.match(/"/g);(((null==a?void 0:a.length)??0)%2==0&&!r||r.length%2!=0)&&(n=n.replace(/'/g,'"'));try{o=JSON.parse(n),e&&(o={...e,...o})}catch(l){return this.logger.warn(`failed parsing options string in nesting for key ${t}`,l),`${t}${s}${n}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,t};for(;s=this.nestingRegexp.exec(t);){let r=[];o={...n},o=o.replace&&!h(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let l=!1;if(-1!==s[0].indexOf(this.formatSeparator)&&!/{.*}/.test(s[1])){const t=s[1].split(this.formatSeparator).map((t=>t.trim()));s[1]=t.shift(),r=t,l=!0}if(i=e(a.call(this,s[1].trim(),o),o),i&&s[0]===t&&!h(i))return i;h(i)||(i=c(i)),i||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),i=""),l&&(i=r.reduce(((t,e)=>this.format(t,e,n.lng,{...n,interpolationkey:s[1].trim()})),i.trim())),t=t.replace(s[0],i),this.regexp.lastIndex=0}return t}}const z=t=>{const e={};return(s,i,o)=>{let n=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(n={...n,[o.interpolationkey]:void 0});const a=i+JSON.stringify(n);let r=e[a];return r||(r=t(O(i),o),e[a]=r),r(s)}};class G{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=$.create("formatter"),this.options=t,this.formats={number:z(((t,e)=>{const s=new Intl.NumberFormat(t,{...e});return t=>s.format(t)})),currency:z(((t,e)=>{const s=new Intl.NumberFormat(t,{...e,style:"currency"});return t=>s.format(t)})),datetime:z(((t,e)=>{const s=new Intl.DateTimeFormat(t,{...e});return t=>s.format(t)})),relativetime:z(((t,e)=>{const s=new Intl.RelativeTimeFormat(t,{...e});return t=>s.format(t,e.range||"day")})),list:z(((t,e)=>{const s=new Intl.ListFormat(t,{...e});return t=>s.format(t)}))},this.init(t)}init(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=e.interpolation.formatSeparator||","}add(t,e){this.formats[t.toLowerCase().trim()]=e}addCached(t,e){this.formats[t.toLowerCase().trim()]=z(e)}format(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=e.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find((t=>t.indexOf(")")>-1))){const t=o.findIndex((t=>t.indexOf(")")>-1));o[0]=[o[0],...o.splice(1,t)].join(this.formatSeparator)}return o.reduce(((t,e)=>{var o;const{formatName:n,formatOptions:a}=(t=>{let e=t.toLowerCase().trim();const s={};if(t.indexOf("(")>-1){const i=t.split("(");e=i[0].toLowerCase().trim();const o=i[1].substring(0,i[1].length-1);"currency"===e&&o.indexOf(":")<0?s.currency||(s.currency=o.trim()):"relativetime"===e&&o.indexOf(":")<0?s.range||(s.range=o.trim()):o.split(";").forEach((t=>{if(t){const[e,...i]=t.split(":"),o=i.join(":").trim().replace(/^'+|'+$/g,""),n=e.trim();s[n]||(s[n]=o),"false"===o&&(s[n]=!1),"true"===o&&(s[n]=!0),isNaN(o)||(s[n]=parseInt(o,10))}}))}return{formatName:e,formatOptions:s}})(e);if(this.formats[n]){let e=t;try{const r=(null==(o=null==i?void 0:i.formatParams)?void 0:o[i.interpolationkey])||{},l=r.locale||r.lng||i.locale||i.lng||s;e=this.formats[n](t,l,{...a,...i,...r})}catch(r){this.logger.warn(r)}return e}return this.logger.warn(`there was no format function for ${n}`),t}),t)}}class B extends P{constructor(t,e,s){var i,o;let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=t,this.store=e,this.services=s,this.languageUtils=s.languageUtils,this.options=n,this.logger=$.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],null==(o=null==(i=this.backend)?void 0:i.init)||o.call(i,s,n.backend,n)}queueLoad(t,e,s,i){const o={},n={},a={},r={};return t.forEach((t=>{let i=!0;e.forEach((e=>{const a=`${t}|${e}`;!s.reload&&this.store.hasResourceBundle(t,e)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===n[a]&&(n[a]=!0):(this.state[a]=1,i=!1,void 0===n[a]&&(n[a]=!0),void 0===o[a]&&(o[a]=!0),void 0===r[e]&&(r[e]=!0)))})),i||(a[t]=!0)})),(Object.keys(o).length||Object.keys(n).length)&&this.queue.push({pending:n,pendingCount:Object.keys(n).length,loaded:{},errors:[],callback:i}),{toLoad:Object.keys(o),pending:Object.keys(n),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(r)}}loaded(t,e,s){const i=t.split("|"),o=i[0],n=i[1];e&&this.emit("failedLoading",o,n,e),!e&&s&&this.store.addResourceBundle(o,n,s,void 0,void 0,{skipCopy:!0}),this.state[t]=e?-1:2,e&&s&&(this.state[t]=0);const a={};this.queue.forEach((s=>{((t,e,s)=>{const{obj:i,k:o}=f(t,e,Object);i[o]=i[o]||[],i[o].push(s)})(s.loaded,[o],n),((t,e)=>{void 0!==t.pending[e]&&(delete t.pending[e],t.pendingCount--)})(s,t),e&&s.errors.push(e),0!==s.pendingCount||s.done||(Object.keys(s.loaded).forEach((t=>{a[t]||(a[t]={});const e=s.loaded[t];e.length&&e.forEach((e=>{void 0===a[t][e]&&(a[t][e]=!0)}))})),s.done=!0,s.errors.length?s.callback(s.errors):s.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((t=>!t.done))}read(t,e,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,n=arguments.length>5?arguments[5]:void 0;if(!t.length)return n(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:t,ns:e,fcName:s,tried:i,wait:o,callback:n});this.readingCalls++;const a=(a,r)=>{if(this.readingCalls--,this.waitingReads.length>0){const t=this.waitingReads.shift();this.read(t.lng,t.ns,t.fcName,t.tried,t.wait,t.callback)}a&&r&&i<this.maxRetries?setTimeout((()=>{this.read.call(this,t,e,s,i+1,2*o,n)}),o):n(a,r)},r=this.backend[s].bind(this.backend);if(2!==r.length)return r(t,e,a);try{const s=r(t,e);s&&"function"==typeof s.then?s.then((t=>a(null,t))).catch(a):a(null,s)}catch(l){a(l)}}prepareLoading(t,e){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),i&&i();h(t)&&(t=this.languageUtils.toResolveHierarchy(t)),h(e)&&(e=[e]);const o=this.queueLoad(t,e,s,i);if(!o.toLoad.length)return o.pending.length||i(),null;o.toLoad.forEach((t=>{this.loadOne(t)}))}load(t,e,s){this.prepareLoading(t,e,{},s)}reload(t,e,s){this.prepareLoading(t,e,{reload:!0},s)}loadOne(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const s=t.split("|"),i=s[0],o=s[1];this.read(i,o,"read",void 0,void 0,((s,n)=>{s&&this.logger.warn(`${e}loading namespace ${o} for language ${i} failed`,s),!s&&n&&this.logger.log(`${e}loaded namespace ${o} for language ${i}`,n),this.loaded(t,s,n)}))}saveMissing(t,e,s,i,o){var n,a,r,l,h;let d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(!(null==(a=null==(n=this.services)?void 0:n.utils)?void 0:a.hasLoadedNamespace)||(null==(l=null==(r=this.services)?void 0:r.utils)?void 0:l.hasLoadedNamespace(e))){if(null!=s&&""!==s){if(null==(h=this.backend)?void 0:h.create){const n={...d,isUpdate:o},a=this.backend.create.bind(this.backend);if(a.length<6)try{let o;o=5===a.length?a(t,e,s,i,n):a(t,e,s,i),o&&"function"==typeof o.then?o.then((t=>c(null,t))).catch(c):c(null,o)}catch(u){c(u)}else a(t,e,s,i,c,n)}t&&t[0]&&this.store.addResource(t[0],e,s,i)}}else this.logger.warn(`did not save key "${s}" as the namespace "${e}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const H=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:t=>{let e={};if("object"==typeof t[1]&&(e=t[1]),h(t[1])&&(e.defaultValue=t[1]),h(t[2])&&(e.tDescription=t[2]),"object"==typeof t[2]||"object"==typeof t[3]){const s=t[3]||t[2];Object.keys(s).forEach((t=>{e[t]=s[t]}))}return e},interpolation:{escapeValue:!0,format:t=>t,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),K=t=>{var e,s;return h(t.ns)&&(t.ns=[t.ns]),h(t.fallbackLng)&&(t.fallbackLng=[t.fallbackLng]),h(t.fallbackNS)&&(t.fallbackNS=[t.fallbackNS]),(null==(s=null==(e=t.supportedLngs)?void 0:e.indexOf)?void 0:s.call(e,"cimode"))<0&&(t.supportedLngs=t.supportedLngs.concat(["cimode"])),"boolean"==typeof t.initImmediate&&(t.initAsync=t.initImmediate),t},W=()=>{};class _ extends P{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;var s;if(super(),this.options=K(t),this.services={},this.logger=$,this.modules={external:[]},s=this,Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach((t=>{"function"==typeof s[t]&&(s[t]=s[t].bind(s))})),e&&!this.isInitialized&&!t.isClone){if(!this.options.initAsync)return this.init(t,e),this;setTimeout((()=>{this.init(t,e)}),0)}}init(){var t=this;let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof e&&(s=e,e={}),!e.defaultNS&&!1!==e.defaultNS&&e.ns&&(h(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const i=H();this.options={...i,...this.options,...K(e)},this.options.interpolation={...i.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const o=t=>t?"function"==typeof t?new t:t:null;if(!this.options.isClone){let e;this.modules.logger?$.init(o(this.modules.logger),this.options):$.init(null,this.options),e=this.modules.formatter?this.modules.formatter:G;const s=new E(this.options);this.store=new R(this.options.resources,this.options);const n=this.services;n.logger=$,n.resourceStore=this.store,n.languageUtils=s,n.pluralResolver=new D(s,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!e||this.options.interpolation.format&&this.options.interpolation.format!==i.interpolation.format||(n.formatter=o(e),n.formatter.init(n,this.options),this.options.interpolation.format=n.formatter.format.bind(n.formatter)),n.interpolator=new V(this.options),n.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},n.backendConnector=new B(o(this.modules.backend),n.resourceStore,n,this.options),n.backendConnector.on("*",(function(e){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];t.emit(e,...i)})),this.modules.languageDetector&&(n.languageDetector=o(this.modules.languageDetector),n.languageDetector.init&&n.languageDetector.init(n,this.options.detection,this.options)),this.modules.i18nFormat&&(n.i18nFormat=o(this.modules.i18nFormat),n.i18nFormat.init&&n.i18nFormat.init(this)),this.translator=new I(this.services,this.options),this.translator.on("*",(function(e){for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];t.emit(e,...i)})),this.modules.external.forEach((t=>{t.init&&t.init(this)}))}if(this.format=this.options.interpolation.format,s||(s=W),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const t=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);t.length>0&&"dev"!==t[0]&&(this.options.lng=t[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=function(){return t.store[e](...arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=function(){return t.store[e](...arguments),t}}));const n=d(),a=()=>{const t=(t,e)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),n.resolve(e),s(t,e)};if(this.languages&&!this.isInitialized)return t(null,this.t.bind(this));this.changeLanguage(this.options.lng,t)};return this.options.resources||!this.options.initAsync?a():setTimeout(a,0),n}loadResources(t){var e,s;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W;const o=h(t)?t:this.language;if("function"==typeof t&&(i=t),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===(null==o?void 0:o.toLowerCase())&&(!this.options.preload||0===this.options.preload.length))return i();const t=[],n=e=>{e&&"cimode"!==e&&this.services.languageUtils.toResolveHierarchy(e).forEach((e=>{"cimode"!==e&&t.indexOf(e)<0&&t.push(e)}))};o?n(o):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((t=>n(t))),null==(s=null==(e=this.options.preload)?void 0:e.forEach)||s.call(e,(t=>n(t))),this.services.backendConnector.load(t,this.options.ns,(t=>{t||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),i(t)}))}else i(null)}reloadResources(t,e,s){const i=d();return"function"==typeof t&&(s=t,t=void 0),"function"==typeof e&&(s=e,e=void 0),t||(t=this.languages),e||(e=this.options.ns),s||(s=W),this.services.backendConnector.reload(t,e,(t=>{i.resolve(),s(t)})),i}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===t.type&&(this.modules.backend=t),("logger"===t.type||t.log&&t.warn&&t.error)&&(this.modules.logger=t),"languageDetector"===t.type&&(this.modules.languageDetector=t),"i18nFormat"===t.type&&(this.modules.i18nFormat=t),"postProcessor"===t.type&&N.addPostProcessor(t),"formatter"===t.type&&(this.modules.formatter=t),"3rdParty"===t.type&&this.modules.external.push(t),this}setResolvedLanguage(t){if(t&&this.languages&&!(["cimode","dev"].indexOf(t)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(t,e){var s=this;this.isLanguageChangingTo=t;const i=d();this.emit("languageChanging",t);const o=t=>{this.language=t,this.languages=this.services.languageUtils.toResolveHierarchy(t),this.resolvedLanguage=void 0,this.setResolvedLanguage(t)},n=(t,n)=>{n?(o(n),this.translator.changeLanguage(n),this.isLanguageChangingTo=void 0,this.emit("languageChanged",n),this.logger.log("languageChanged",n)):this.isLanguageChangingTo=void 0,i.resolve((function(){return s.t(...arguments)})),e&&e(t,(function(){return s.t(...arguments)}))},a=e=>{var s,i;t||e||!this.services.languageDetector||(e=[]);const a=h(e)?e:this.services.languageUtils.getBestMatchFromCodes(e);a&&(this.language||o(a),this.translator.language||this.translator.changeLanguage(a),null==(i=null==(s=this.services.languageDetector)?void 0:s.cacheUserLanguage)||i.call(s,a)),this.loadResources(a,(t=>{n(t,a)}))};return t||!this.services.languageDetector||this.services.languageDetector.async?!t&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(t):a(this.services.languageDetector.detect()),i}getFixedT(t,e,s){var i=this;const o=function(t,e){let n;if("object"!=typeof e){for(var a=arguments.length,r=new Array(a>2?a-2:0),l=2;l<a;l++)r[l-2]=arguments[l];n=i.options.overloadTranslationOptionHandler([t,e].concat(r))}else n={...e};n.lng=n.lng||o.lng,n.lngs=n.lngs||o.lngs,n.ns=n.ns||o.ns,""!==n.keyPrefix&&(n.keyPrefix=n.keyPrefix||s||o.keyPrefix);const h=i.options.keySeparator||".";let d;return d=n.keyPrefix&&Array.isArray(t)?t.map((t=>`${n.keyPrefix}${h}${t}`)):n.keyPrefix?`${n.keyPrefix}${h}${t}`:t,i.t(d,n)};return h(t)?o.lng=t:o.lngs=t,o.ns=e,o.keyPrefix=s,o}t(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return null==(t=this.translator)?void 0:t.translate(...s)}exists(){for(var t,e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return null==(t=this.translator)?void 0:t.exists(...s)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const s=e.lng||this.resolvedLanguage||this.languages[0],i=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===s.toLowerCase())return!0;const n=(t,e)=>{const s=this.services.backendConnector.state[`${t}|${e}`];return-1===s||0===s||2===s};if(e.precheck){const t=e.precheck(this,n);if(void 0!==t)return t}return!(!this.hasResourceBundle(s,t)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!n(s,t)||i&&!n(o,t)))}loadNamespaces(t,e){const s=d();return this.options.ns?(h(t)&&(t=[t]),t.forEach((t=>{this.options.ns.indexOf(t)<0&&this.options.ns.push(t)})),this.loadResources((t=>{s.resolve(),e&&e(t)})),s):(e&&e(),Promise.resolve())}loadLanguages(t,e){const s=d();h(t)&&(t=[t]);const i=this.options.preload||[],o=t.filter((t=>i.indexOf(t)<0&&this.services.languageUtils.isSupportedCode(t)));return o.length?(this.options.preload=i.concat(o),this.loadResources((t=>{s.resolve(),e&&e(t)})),s):(e&&e(),Promise.resolve())}dir(t){var e,s;if(t||(t=this.resolvedLanguage||((null==(e=this.languages)?void 0:e.length)>0?this.languages[0]:this.language)),!t)return"rtl";const i=(null==(s=this.services)?void 0:s.languageUtils)||new E(H());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(i.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new _(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:W;const s=t.forkResourceStore;s&&delete t.forkResourceStore;const i={...this.options,...t,isClone:!0},o=new _(i);return void 0===t.debug&&void 0===t.prefix||(o.logger=o.logger.clone(t)),["store","services","language"].forEach((t=>{o[t]=this[t]})),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},s&&(o.store=new R(this.store.data,i),o.services.resourceStore=o.store),o.translator=new I(o.services,i),o.translator.on("*",(function(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),i=1;i<e;i++)s[i-1]=arguments[i];o.emit(t,...s)})),o.init(i,e),o.translator.options=i,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const J=_.createInstance();J.createInstance=_.createInstance,J.createInstance,J.dir,J.init,J.loadResources,J.reloadResources,J.use,J.changeLanguage,J.getFixedT,J.t,J.exists,J.setDefaultNamespace,J.hasLoadedNamespace,J.loadNamespaces,J.loadLanguages,J.init({lng:"en",fallbackLng:"en",debug:!0,resources:{en:{translation:{instructions:"To move use WASD\n Use spacebar to advance the day\n Use the save and load buttons to save and load your game into that slot\n The undo and redo button undo and redo actions",display:"Use the plant buttons to plant into the corresponding cells","Return to Game":"Return to Game"},buttons:{save1:"Save Slot One",save2:"Save Slot Two",save3:"Save Slot Three",load1:"Load Slot One",load2:"Load Slot Two",load3:"Load Slot Three",undo:"Undo",redo:"Redo"}},zh:{translation:{instructions:"使用WASD移动\n 按空格键进入下一天\n 使用保存和加载按钮保存和加载游戏到对应的存档槽\n 撤销和重做按钮可撤销和重做操作",display:"使用种植按钮在对应的单元格中种植","Return to Game":"返回游戏"},buttons:{save1:"保存到存档槽一",save2:"保存到存档槽二",save3:"保存到存档槽三",load1:"加载存档槽一",load2:"加载存档槽二",load3:"加载存档槽三",undo:"撤销",redo:"重做"}},ar:{translation:{instructions:"للتحرك استخدم WASD\n اضغط على مفتاح المسافة للتقدم إلى اليوم التالي\n استخدم أزرار الحفظ والتحميل لحفظ لعبتك وتحميلها إلى الفتحة المحددة\n يمكن لزر التراجع والإعادة التراجع عن الإجراءات وإعادتها",display:"استخدم أزرار الزرع للزرع في الخلايا المقابلة","Return to Game":"العودة إلى اللعبة"},buttons:{save1:"حفظ في الفتحة الأولى",save2:"حفظ في الفتحة الثانية",save3:"حفظ في الفتحة الثالثة",load1:"تحميل من الفتحة الأولى",load2:"تحميل من الفتحة الثانية",load3:"تحميل من الفتحة الثالثة",undo:"تراجع",redo:"إعادة"}}}}).then((()=>{console.log(J.t("instructions"))}));class q extends s.Scene{constructor(){super("Game"),e(this,"camera"),e(this,"background"),e(this,"msg_text"),e(this,"hover_text"),e(this,"player"),e(this,"cursors"),e(this,"days"),e(this,"tileWidth"),e(this,"tileHeight"),e(this,"levelWidth"),e(this,"levelHeight"),e(this,"offsetX"),e(this,"offsetY"),e(this,"victoryScenario",!1),e(this,"winCondition"),e(this,"fullyGrownPlants",0),e(this,"plantTypes",r),e(this,"plantButtons"),e(this,"selectedPlantType"),e(this,"tileAttributes"),e(this,"plantSprites"),e(this,"undoStack",[]),e(this,"redoStack",[]),this.tileAttributes=[],this.tileWidth=75,this.tileHeight=75,this.days=0,this.offsetX=0,this.offsetY=0,this.selectedPlantType=null}serializeStateToByteArray(){const t=new Float32Array(this.tileAttributes.flatMap((t=>t.map((t=>t.water))))),e=new Float32Array(this.tileAttributes.flatMap((t=>t.map((t=>t.sunEnergy))))),s=new Int32Array(this.tileAttributes.flatMap((t=>t.map((t=>t.plant?this.plantTypes.findIndex((e=>e.name===t.plant.name)):-1))))),i=new Int32Array(this.tileAttributes.flatMap((t=>t.map((t=>t.plant?t.plant.growthStage:0))))),o=new Int32Array(this.tileAttributes.flatMap((t=>t.map((t=>t.plant?t.plant.daysPlanted:0))))),n=new Int32Array([this.days]),a=new Int32Array([this.fullyGrownPlants]),r=t.byteLength+e.byteLength+s.byteLength+i.byteLength+o.byteLength+n.byteLength+a.byteLength,l=new Uint8Array(r);let h=0;return l.set(new Uint8Array(t.buffer),h),h+=t.byteLength,l.set(new Uint8Array(e.buffer),h),h+=e.byteLength,l.set(new Uint8Array(s.buffer),h),h+=s.byteLength,l.set(new Uint8Array(i.buffer),h),h+=i.byteLength,l.set(new Uint8Array(o.buffer),h),h+=o.byteLength,l.set(new Uint8Array(n.buffer),h),h+=n.byteLength,l.set(new Uint8Array(a.buffer),h),l}deserializeStateFromByteArray(t){if(!this.tileAttributes||!Array.isArray(this.tileAttributes)||!this.tileAttributes[0])return void console.error("tileAttributes is not properly initialized or has no rows");if(0===this.tileAttributes.length||0===this.tileAttributes[0].length)return void console.error("tileAttributes grid is not initialized correctly");const e=this.tileAttributes.length*this.tileAttributes[0].length,s=new Float32Array(t.buffer.slice(0,4*e)),i=new Float32Array(t.buffer.slice(4*e,8*e)),o=new Int32Array(t.buffer.slice(8*e,12*e)),n=new Int32Array(t.buffer.slice(12*e,16*e)),a=new Int32Array(t.buffer.slice(16*e,20*e)),r=new Int32Array(t.buffer.slice(20*e,24*e));this.days=r[0];const l=new Int32Array(t.buffer.slice(24*e,28*e));this.fullyGrownPlants=l[0];let h=0;for(let d=0;d<this.tileAttributes.length;d++)for(let t=0;t<this.tileAttributes[d].length;t++){const e=this.tileAttributes[d][t];e.water=s[h],e.sunEnergy=i[h];const r=o[h];r>=0&&r<this.plantTypes.length?e.plant={...this.plantTypes[r],growthStage:n[h],daysPlanted:a[h],hasReachedMaxGrowth:2===n[h]}:e.plant=null,h++}this.refreshPlantGrowth(),this.msg_text.setText(`Day: ${this.days}`)}saveGameState(t,e=!1){const s=this.serializeStateToByteArray(),i=btoa(String.fromCharCode(...s)),o=e?"autoSave":`gameState_slot_${t}`,n=e?"autoSaveUndoStack":`undoStack_slot_${t}`,a=e?"autoSaveRedoStack":`redoStack_slot_${t}`;localStorage.setItem(o,i),localStorage.setItem(n,JSON.stringify(this.undoStack)),localStorage.setItem(a,JSON.stringify(this.redoStack)),console.log((e?"Auto":"Manual")+" save completed!")}loadGameState(t){const e=`gameState_slot_${t}`,s=localStorage.getItem(e);if(s){const e=new Uint8Array(atob(s).split("").map((t=>t.charCodeAt(0))));this.deserializeStateFromByteArray(e),console.log(`Game loaded from slot ${t}`);const i=`undoStack_slot_${t}`,o=`redoStack_slot_${t}`,n=localStorage.getItem(i),a=localStorage.getItem(o);this.undoStack=n?JSON.parse(n):[],this.redoStack=a?JSON.parse(a):[]}else console.log(`No saved game state found in slot ${t}. Initializing empty state.`),this.initializeTileAttributes(),this.days=0}loadAutoSave(){const t=localStorage.getItem("autoSave");if(console.log(`This is tile attributes: ${this.tileAttributes}`),t){const e=new Uint8Array(atob(t).split("").map((t=>t.charCodeAt(0))));this.deserializeStateFromByteArray(e),console.log(`${this.tileAttributes}`),console.log("Auto-save loaded.");const s=localStorage.getItem("autoSaveUndoStack"),i=localStorage.getItem("autoSaveRedoStack");this.undoStack=s?JSON.parse(s):[],this.redoStack=i?JSON.parse(i):[]}else console.log("No auto-save found."),this.startNewGame()}askContinue(){localStorage.getItem("autoSave")&&(confirm("Do you want to continue where you left off?")?(console.log("Continuing from auto-save..."),this.loadAutoSave(),console.log(`${this.tileAttributes}`)):(console.log("Starting new game..."),this.startNewGame()))}startNewGame(){localStorage.removeItem("autoSave"),this.days=0,this.initializeTileAttributes(),console.log("New game started.")}initializeTileAttributes(t=[]){0===t.length&&(t=[[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]);for(let e=0;e<t.length;e++){this.tileAttributes[e]=[];for(let s=0;s<t[e].length;s++)this.tileAttributes[e][s]={water:5*Math.random(),sunEnergy:10*Math.random(),plant:null}}}saveStateToUndoStack(){const t=this.serializeStateToByteArray();this.undoStack.push(t),this.redoStack=[]}undo(){if(this.undoStack.length>0){const t=this.undoStack.pop();t?(this.redoStack.push(this.serializeStateToByteArray()),this.deserializeStateFromByteArray(t)):console.error("Failed to undo: previous state is undefined")}}redo(){if(this.redoStack.length>0){const t=this.redoStack.pop();t?(this.undoStack.push(this.serializeStateToByteArray()),this.deserializeStateFromByteArray(t)):console.error("Failed to redo: next state is undefined")}}create(t){var e;const s=t.mode,o=t.externalDSL;console.log(s),this.levelWidth=o.levelWidth,this.levelHeight=o.levelHeight,this.winCondition=o.winCondition,this.camera=this.cameras.main,this.background=this.add.tileSprite(0,0,1024,768,"background").setOrigin(0,0);const n=Array.from({length:this.levelHeight},(()=>Array(this.levelWidth).fill(0))),a=this.make.tilemap({data:n,tileWidth:this.tileWidth,tileHeight:this.tileHeight}),h=a.addTilesetImage("dirt");if(!h)return void console.error("Tileset 'dirt' not found. Check the preload key and file path.");const d=n[0].length*this.tileWidth,c=n.length*this.tileHeight,u=this.scale.width,g=this.scale.height;if(this.offsetX=(u-d)/2,this.offsetY=(g-c)/2,null==(e=a.createLayer(0,h,this.offsetX,this.offsetY))||e.setOrigin(0,0),this.initializeTileAttributes(n),0===this.tileAttributes.length||0===this.tileAttributes[0].length){const t=10,e=10;this.tileAttributes=Array.from({length:t},(()=>Array.from({length:e},(()=>({water:0,sunEnergy:0,plant:null})))))}const p=[],f=[];for(let i=0;i<3;i++){const t=this.add.text(800,50+40*i,`Save Slot ${i+1}`,{fontSize:"20px",color:"#ffffff",backgroundColor:"#00ff00",padding:{x:10,y:5}}).setInteractive().on("pointerdown",(()=>this.saveGameState(i+1)),!1);p.push(t);const e=this.add.text(600,50+40*i,`Load Slot ${i+1}`,{fontSize:"20px",color:"#ffffff",backgroundColor:"#ff0000",padding:{x:10,y:5}}).setInteractive().on("pointerdown",(()=>this.loadGameState(i+1)),!1);f.push(e)}var y;[...p,...f].forEach((t=>{t.on("pointerover",(()=>t.setStyle({fill:"#ffff00"}))),t.on("pointerout",(()=>t.setStyle({fill:"#ffffff"})))})),this.add.text(20,500,"Undo",{fontSize:"20px",color:"#ffffff",backgroundColor:"#00ff00",padding:{x:10,y:5}}).setInteractive().on("pointerdown",(()=>this.undo())),this.add.text(120,500,"Redo",{fontSize:"20px",color:"#ffffff",backgroundColor:"#00ff00",padding:{x:10,y:5}}).setInteractive().on("pointerdown",(()=>this.redo())),(y=this).anims.create({key:"walk",frames:y.anims.generateFrameNumbers("player",{start:1,end:2}),frameRate:10,repeat:-1}),this.player=function(t){const e=t.physics.add.sprite(t.scale.width/2,t.scale.height/2,"player");return e.setCollideWorldBounds(!0),e.setScale(.4),e}(this),this.msg_text=this.add.text(10,10,`Day: ${this.days}`,{font:"18px Arial",color:"#ffffff"}),this.hover_text=this.add.text(0,0,"",{font:"16px Arial",color:"#ffcc00",backgroundColor:"#000000",padding:{x:5,y:5}}).setVisible(!1),this.add.text(this.scale.width-170,10,J.t("Instructions"),{fontSize:"20px",color:"#ffffff",backgroundColor:"#ff7700",padding:{x:10,y:5}}).setInteractive().on("pointerdown",(()=>{this.scene.pause(),this.scene.launch("HelpScene")})),this.cursors=function(t){var e;return t.cursors=null==(e=t.input.keyboard)?void 0:e.addKeys({up:i.Input.Keyboard.KeyCodes.W,down:i.Input.Keyboard.KeyCodes.S,left:i.Input.Keyboard.KeyCodes.A,right:i.Input.Keyboard.KeyCodes.D,space:i.Input.Keyboard.KeyCodes.SPACE})}(this),this.plantSprites=this.add.group(),this.input.on("pointermove",(t=>{!function(t,e){const s=Math.floor((e.x-t.offsetX)/t.tileWidth),i=Math.floor((e.y-t.offsetY)/t.tileHeight);if(s>=0&&i>=0&&i<t.tileAttributes.length&&s<t.tileAttributes[i].length){const o=t.tileAttributes[i][s];t.hover_text.setText(`Sun: ${o.sunEnergy.toFixed(2)}\nWater: ${o.water.toFixed(2)}${o.plant?`\nPlant: ${o.plant.name} (Stage: ${o.plant.growthStage})`:""}`),t.hover_text.setPosition(e.x+10,e.y+10),t.hover_text.setVisible(!0)}else t.hover_text.setVisible(!1)}(this,t)})),function(t){const e=t.scale.height-50*r.length-20;t.plantButtons=t.add.container(),r.forEach(((s,i)=>{const o=e+50*i,n=t.add.rectangle(20,o,120,40,2236962).setOrigin(0,0).setInteractive({useHandCursor:!0}),a=t.add.text(30,o+10,s.name,{font:"18px Arial",color:"#ffffff"});n.on("pointerdown",(()=>{t.selectedPlantType=i,console.log(`Selected plant: ${s.name}`),l(t)})),t.plantButtons.add(n),t.plantButtons.add(a)}))}(this),l(this),this.input.on("pointerdown",(t=>{const e=Math.floor((t.x-this.offsetX)/this.tileWidth),s=Math.floor((t.y-this.offsetY)/this.tileHeight);e>=0&&s>=0&&s<this.tileAttributes.length&&e<this.tileAttributes[s].length&&null!==this.selectedPlantType&&(null!==this.selectedPlantType?this.plant(e,s,this.selectedPlantType):this.reap(e,s))})),this.askContinue()}isNearTile(t,e){const s=this.offsetX+t*this.tileWidth+this.tileWidth/2,i=this.offsetY+e*this.tileHeight+this.tileHeight/2;return Phaser.Math.Distance.Between(this.player.x,this.player.y,s,i)<=this.tileWidth}plant(t,e,s){const i=this.tileAttributes[e][t],o=this.plantTypes[s];this.isNearTile(t,e)?i.plant?console.log("Tile already has a plant!"):i.water>=o.requiredWater&&i.sunEnergy>=o.requiredSunEnergy?(i.plant={...o,growthStage:0,daysPlanted:this.days},console.log(`Planted ${o.name} at (${t}, ${e})`),this.saveStateToUndoStack(),this.saveGameState(0,!0)):console.log("Insufficient resources to plant here!"):console.log("You need to be near the tile to plant!")}reap(t,e){const s=this.tileAttributes[e][t];this.isNearTile(t,e)?s.plant?(console.log(`Reaped ${s.plant.name} from (${t}, ${e})`),s.plant=null,this.saveStateToUndoStack(),this.saveGameState(0,!0)):console.log("No plant to reap here!"):console.log("You need to be near the tile to reap!")}advanceDay(){this.days++,this.msg_text.setText(`Day: ${this.days}`),this.saveStateToUndoStack();for(let t=0;t<this.tileAttributes.length;t++)for(let e=0;e<this.tileAttributes[t].length;e++){const s=this.tileAttributes[t][e];if(s.sunEnergy=10*Math.random(),s.water=Math.min(10,s.water+2*Math.random()),s.plant){const i=s.plant,o=this.days-i.daysPlanted;if(2===i.growthStage){i.hasReachedMaxGrowth||(this.fullyGrownPlants++,i.hasReachedMaxGrowth=!0);continue}const n=1-.05*this.getAdjacentSameTypePlants(e,t,i),a=Math.max(i.growthTime*n,1);o>=a&&i.growthStage<2?(i.growthStage=2,i.hasReachedMaxGrowth||(this.fullyGrownPlants++,i.hasReachedMaxGrowth=!0)):i.growthStage=o>=a/2?1:0}}console.log(`Fully grown plants count: ${this.fullyGrownPlants}`),this.checkvictoryCompletion(),this.saveGameState(0,!0)}checkvictoryCompletion(){this.fullyGrownPlants>=this.winCondition&&!this.victoryScenario&&(this.victoryScenario=!0,console.log(`Victory! At least ${this.winCondition} plants are fully grown.`),this.msg_text.setText(`Day: ${this.days} - Scenario Completed!`),this.scene.start("GameOver"))}getAdjacentSameTypePlants(t,e,s){const i=this.getNeighbors(t,e);let o=0;for(const n of i){const t=this.tileAttributes[n.y][n.x];t.plant&&t.plant.name===s.name&&o++}return o}canGrow(t,e){const s=this.getNeighbors(t,e);let i=0;for(const o of s)this.tileAttributes[o.y][o.x].plant&&i++;return i>=1}getNeighbors(t,e){const s=[],i=[{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}];for(const o of i){const i=t+o.x,n=e+o.y;i>=0&&n>=0&&n<this.tileAttributes.length&&i<this.tileAttributes[n].length&&s.push({x:i,y:n})}return s}refreshPlantGrowth(){for(let t=0;t<this.tileAttributes.length;t++)for(let e=0;e<this.tileAttributes[t].length;e++){const s=this.tileAttributes[t][e];if(s.plant){const t=s.plant,e=this.days-t.daysPlanted;e>=t.growthTime?(t.growthStage=2,t.hasReachedMaxGrowth=!0):e>=t.growthTime/2?t.growthStage=1:t.growthStage=0}}}update(){this.player.setVelocity(0),this.cursors.left.isDown?(this.player.setVelocityX(-150),this.player.flipX=!0,this.player.play("walk",!0)):this.cursors.right.isDown?(this.player.setVelocityX(150),this.player.flipX=!1,this.player.play("walk",!0)):this.cursors.up.isDown?(this.player.setVelocityY(-150),this.player.play("walk",!0)):this.cursors.down.isDown?(this.player.setVelocityY(150),this.player.play("walk",!0)):(this.player.anims.stop(),this.player.setFrame(0)),Phaser.Input.Keyboard.JustDown(this.cursors.space)&&this.advanceDay(),this.plantSprites.clear(!0,!0);for(let t=0;t<this.tileAttributes.length;t++)for(let e=0;e<this.tileAttributes[t].length;e++){const s=this.tileAttributes[t][e];if(s.plant){const i=s.plant,o=this.add.sprite(this.offsetX+e*this.tileWidth+this.tileWidth/2,this.offsetY+t*this.tileHeight+this.tileHeight/2,i.sprite);0===i.growthStage?o.setScale(.25):1===i.growthStage?o.setScale(.35):2===i.growthStage&&o.setScale(.45),this.plantSprites.add(o)}}}}class Y extends s.Scene{constructor(){super("GameOver"),e(this,"camera"),e(this,"background"),e(this,"gameover_text")}create(){this.camera=this.cameras.main,this.camera.setBackgroundColor(16711680),this.background=this.add.image(512,384,"background"),this.background.setAlpha(.5),this.gameover_text=this.add.text(512,384,"Game Over",{fontFamily:"Arial Black",fontSize:64,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"}),this.gameover_text.setOrigin(.5),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}}class X extends s.Scene{constructor(){super("MainMenu"),e(this,"background"),e(this,"logo"),e(this,"title")}startGame(t){this.loadexternalDSL(t)}loadexternalDSL(t){fetch("src/externalDSL.json").then((t=>t.json())).then((e=>{const s="tutorial"===t?e.tutorial:e.normal;this.scene.start("Game",{mode:t,externalDSL:s})})).catch((t=>{console.error("Error loading ExternalDSL:",t)}))}create(){this.background=this.add.tileSprite(0,0,1024,768,"background").setOrigin(0,0),this.title=this.add.text(this.scale.width/2,this.scale.height/2,"Harvest Festival!",{fontFamily:"Arial Black",fontSize:38,color:"#ffb508",stroke:"#000000",strokeThickness:8,align:"center"}).setOrigin(.5);const t=this.add.text(this.scale.width/2,this.scale.height/2+50,"Normal Mode",{font:"32px Arial",stroke:"#000000",strokeThickness:8}).setOrigin(.5).setInteractive(),e=this.add.text(this.scale.width/2,this.scale.height/2+100,"Tutorial Mode",{font:"32px Arial",color:"#08ffb1",stroke:"#000000",strokeThickness:8}).setOrigin(.5).setInteractive();t.on("pointerdown",(()=>{this.startGame("normal")})),e.on("pointerdown",(()=>{this.startGame("tutorial")}))}}class Q extends s.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets")}create(){this.scene.start("MainMenu")}}class Z extends Phaser.Scene{constructor(){super({key:"HelpScene"})}create(){this.cameras.main.setBackgroundColor("#7702c4");const t=this.add.text(100,100,"English",{fontSize:"20px"}).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.changeLanguage("en"))),e=this.add.text(100,170,"中文",{fontSize:"20px"}).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.changeLanguage("zh"))),s=this.add.text(100,240,"العربية",{fontSize:"20px"}).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.changeLanguage("ar")));this.add.text(100,400,J.t("instructions"),{fontSize:"20px"}).setName("instructions"),this.add.text(100,500,J.t("display"),{fontSize:"20px"}).setName("display"),this.add.text(this.scale.width/2,this.scale.height-50,J.t("ReturntoGame"),{fontSize:"20px",color:"#ffffff",backgroundColor:"#0077ff",padding:{x:10,y:5}}).setOrigin(.5).setInteractive().setName("returnButton").on("pointerdown",(()=>{this.scene.stop(),this.scene.resume("Game")})),t.setBackgroundColor("#0000FF"),e.setBackgroundColor("#FF0000"),s.setBackgroundColor("#00FF00")}changeLanguage(t){J.changeLanguage(t,((e,s)=>{e?console.error("Error changing language:",e):(console.log("Language changed to:",t),this.updateUI())}))}updateUI(){const t=this.children.getByName("instructions"),e=this.children.getByName("display"),s=this.children.getByName("returnButton");t&&e&&s?(t.setText(J.t("instructions")),e.setText(J.t("display")),s.setText(J.t("ReturntoGame"))):console.warn("Text objects not found!")}}const tt={type:Phaser.AUTO,width:1024,height:768,parent:"game-container",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[o,Q,X,q,Z,Y],physics:{default:"arcade",arcade:{gravity:{x:0,y:0},debug:!1}}};new s.Game(tt);
